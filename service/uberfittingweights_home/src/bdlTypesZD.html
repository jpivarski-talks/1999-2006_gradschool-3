<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<title>CLEO III Constants/Snapshot ZD bdl types</title>
</head>

<body bgcolor="#FFFFFF">

<h2 align="center">ZD BDL types</h2>

<hr>

<p>Changes: </p>

<ul>
    <li>11/10/02 T. Meyer: Created page for ZD types.
    <li>11/13/02 huanggs: Match ZD geometry.
    <li>09/19/03 J. Pivarski: Added ZDWeight2*.bdl documentation (and
    corrected some copy-over artifacts (&quot;DR&quot; in links,
    rather than &quot;ZD&quot;!)
</ul>

<hr>

<h2>Innermost Tracking Drift Chamber, "Z" Detector</h2>

<p>A list of all constants types related to the ZD. Follow a
link to see the contents of the BDL and a brief description further down
on this page.

<!-- Index -->
<ul>
  <li><a href="#geometry">Geometry</a></li>
    <ul>
    <li><a href="#azdgeomglobal">AZDGeomGlobal</a></li>
    <li><a href="#azdgeomlayer">AZDGeomLayer</a></li>
    <li><a href="#azdgeomlayersends">AZDGeomLayerEnds</a></li>
    <li><a href="#azdgeomwiresurvey">AZDGeomWireSurvey</a></li>
    </ul>
  <li><a href="#alignment">Alignment</a></li>
    <ul>
    <li><a href="#zdgeomalignment">ZDGeomAlignment</a></li>
    </ul>
  <li><a href="#offline">Offline</a></li>
    <ul>
    <li><a href="#zdadcpedestal">ZDadcpedestal</a></li>
    <li><a href="#zdadcsaturation">ZDadcsaturation</a></li>
    <li><a href="#zdadc2charge">ZDadc2charge</a></li>
    <li><a href="#zdtdc2time">ZDtdc2time</a></li>
    <li><a href="#zdt0global">ZDt0global</a></li>
    <li><a href="#zdt0crate">ZDt0crate</a></li>
    <li><a href="#zdt0card">ZDt0card</a></li>
    <li><a href="#zdt0channel">ZDt0channel</a></li>
    <li><a href="#zdt0channelv2">ZDt0channelv2</a></li>
    <li><a href="#zdt0hvcard">ZDt0hvcard</a></li>
    <li><a href="#zddaqcellidmap">ZDDaqCellIDMap</a></li>
    <li><a href="#zddriftdata">ZDDriftData</a></li>
    <li><a href="#zddriftdatav2">ZDDriftDatav2</a></li>
    <li><a href="#zdgarfield_distancecorrection">ZDGarfield_DistanceCorrection</a></li>
    <li><a href="#zdgarfield_timecorrection">ZDGarfield_TimeCorrection</a></li>
    <li><a href="#zdweightlayer">ZDWeightLayer</a> <i>(Used only for testing)</i></li>
    <li><a href="#zdweightdrift">ZDWeightDrift</a> <i>(Used only for testing)</i></li>
    <li><a href="#zdweighttheta">ZDWeightTheta</a> <i>(Used only for testing)</i></li>
    <li><a href="#zdweightphi">ZDWeightPhi</a> <i>(Used only for testing)</i></li>
    <li><a href="#zdweight2layerdriftentang">ZDWeightLayerDriftEntAng</a></li>
    <li><a href="#zdweight2layertheta">ZDWeightLayerTheta</a></li>
    <li><a href="#zdweight2layerphi">ZDWeightLayerPhi</a></li>
    <li><a href="#zdwirequality">ZDWireQuality</a></li>
    </ul>
  <li><a href="#online">Online</a></li>
    <ul>
    <li><a href="#zdfbus1877s">ZDFBUS1877S</a></li>
    <li><a href="#zdfbuschannel">ZDFBUSChannel</a></li>
    <li><a href="#zdfbussequencerlist">ZDFBUSSequencerList</a></li>
    <li><a href="#zdtqtcrate">ZDTQTCrate</a></li>
    <li><a href="#zdtqtboard">ZDTQTBoard</a></li>
    <li><a href="#zdtqtchannel">ZDTQTChannel</a></li>
    <li><a href="#zdtstrigboard">ZDTSTrigBoard</a></li>
    <li><a href="#zdtsgateboard">ZDTSGateBoard</a></li>
    </ul>
  <li><a href="#miscellaneous">Miscellaneous</a></li>
    <ul>
    <li><a href="#zdelecmap">ZDElecMap</a></li>
    <li><a href="#zdtqttofbus">ZDTQTtoFBUS</a></li>
    <li><a href="#zdpreamptotqt">ZDPreAmpToTQT</a></li>
    <li><a href="#zddeadwires">ZDDeadWires</a></li>
    <li><a href="#zdvarious">ZDvarious</a></li>
    </ul>
  <li><a href="#montecarlo">Monte Carlo</a></li>
</ul>


<a name="geometry"></a>
<h3>ZDGeometry</h3>

<ul>
<a name="azdgeomglobal"></a>
<li><font color="#4b3d8b"><b>AZDGeomGlobal</b></font><br>

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: AZDGeomGlobal
{
   UInt16 ZDGlobalNumber
   UInt16 NumberOfWiresTotal
   UInt16 NumberOfLayers
   UInt16 NumberOfAxialLayers
   UInt16 NumberOfStereoLayers
   UInt16 NumberOfULayers
   UInt16 NumberOfVLayers
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <U>Constants for the Entire ZD</U><br>
  <blockquote>
    # ID of the ZD<BR>
    # of wires in the ZD<BR>
    # of  layers in the ZD<BR>
    # of Axial (nominally) layers<BR>
    # of Stereo layers<BR>
    # of U layers <BR>
    # of V layers<BR>
  </blockquote>
  
  <p>Detailed description is available in <a href=
  "http://www.lns.cornell.edu/restricted/CLEO/CLEO3/soft/LibraryDocs/AZDGeomConst">
  ZD3 Geometry: CLEO III constants</A><br>
  
  Data come from the ZD design.<br>
  Currently hard-wired, DB is not used.<br> 
  If the DB is used, the script should include:
  <blockquote><tt>
    &gt; source_format sel AZDGeomGlobalFileSourceFormat<br>
    &gt; file in $env(C3_LIB)/data/zd.azdgeomglobal basegeometry<br>
  </tt></blockquote></p>
</li><br>

<a name="azdgeomlayer"></a>
<li><font color="#4b3d8b"><b>AZDGeomLayer</b></font><br>

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: AZDGeomLayer
{
    UInt16 ZDLayerNumber
    UInt16 NumberOfWires
    Int8   ReadoutEnd
    double RadiusEndCapCM
    double Phi0EastInDegrees
    double Phi0WestInDegrees
    double TwistCakeInDegrees
    UInt16 CakeNumber_Axial
    UInt16 ZStepPolycone_StereoLayer
    double ZBowingInch
    double ZBushing
    double ZPin
    double Pin_WireRadiusInch
    double SagXMicron
    double SagYMicron
    double FieldRadiusLessEndCapCM
    double FieldRadiusMoreEndCapCM
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <U>Constants for Each ZD Layer:</U><br>
  <blockquote>
    layer # <br>
    # of wires <br>
    Readout End <br>
    design radius at the endcaps <br>
    design phi0 of wire 0, East <br>
    design phi0 of wire 0, West <br>
    twist (endplates are twisted w/r to each other) <br>
    cake number of axial (not used for ZD) <br>
    the index of the polycone z-step (not used for ZD) <br>
    bowing of the endplates <br>
    bushings' length <br>
    pins' length <br>
    (pin radius -wire radius) <br>
    sagx <br>
    sagy <br>
    field layer radius less    than  sense layer radius, at the end cap <br>
    field layer radius greater then  sense wire radius,  at the end cap<br>
  </blockquote>

  <p>Detailed description is available in <a href=
"http://www.lns.cornell.edu/restricted/CLEO/CLEO3/soft/LibraryDocs/AZDGeomConst">
ZD3 Geometry: CLEO III constants</A><br>

  Data come from the ZD design, or were measured during ZD construction<br>
  If the DB is used, the script should include:
  <blockquote><tt>
    &gt; source_format sel AZDGeomLayerFileSourceFormat<br>
    &gt; file in $env(C3_LIB)/data/zd.azdgeomlayer basegeometry<br>
  </tt></blockquote></p>
</li><br>

<a name="azdgeomlayersends"></a>
<li><font color="#4b3d8b"><b>AZDGeomLayersEnds</b></font><br>

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: AZDGeomLayersEnds
{
UInt16 ZDLayerNumber
double Radius_MM
double X_WestMM
double Y_WestMM
double Z_WestMM
double X_EastMM
double Y_EastMM
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <U>Constants of the position of the first wire for Each ZD Layer:</U><br>
  <blockquote>
    layer # <br>
    radius of wire layer <br>
    x at the west endplate <br>
    y at the west endplate <br>
    z at the west endplate <br>
    x at the east endplate <br>
    y at the east endplate <br>
  </blockquote>

  <p>Detailed description is available in <a href=
"http://www.lns.cornell.edu/restricted/CLEO/CLEO3/soft/LibraryDocs/AZDGeomConst">
ZD3 Geometry: CLEO III constants</A><br>

  Data come from the ZD design, or were measured during ZD construction<br>
  If the DB is used, the script should include:
  <blockquote><tt>
    &gt; source_format sel AZDGeomLayersEndsFileSourceFormat<br>
    &gt; file in $env(C3_LIB)/data/zd.azdgeomlayersends basegeometry<br>
  </tt></blockquote></p>
</li><br>

<a name="azdgeomwiresurvey"></a>
<li><font color="#4b3d8b"><b>AZDGeomWireSurvey</b></font><br>

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: AZDGeomWireSurvey
{
   UInt16 ZDWireNumber
   double EastXMicron
   double EastYMicron
   double EastZMicron
   double WestXMicron
   double WestYMicron
   double WestZMicron
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <U>Each ZD Sense Wire:</U><br>
  For each sense wire, we have survey corrections that give, in the local
endcaps' coordinates, the deviation of the surveyed holes positions from
the ideal positions in microns: East(X,Y,Z)Micron and
West(X,Y,Z)Micron.<br>
   The order of wires, and detailed description is available in <a href=
"http://www.lns.cornell.edu/restricted/CLEO/CLEO3/soft/LibraryDocs/AZDGeomConst">
ZD3 Geometry: CLEO III constants</A><br>

  Data come from the survey done during ZD construction<br> 
  Nominal data were written to ascii file C3_LIB/data/zd.azdgeomwiresurvey<br>
  AZDGeomWireSurvey data are used by AZDGeom. The script includes:
  <blockquote><tt>
    &gt; source_format sel AZDGeomWireSurveyFileSourceFormat<br>
    &gt; file in $env(C3_LIB)/data/zd.azdgeomwiresurvey basegeometry<br>
  </tt></blockquote></p>
</li>

</ul>


<a name="alignment"></a>
<h3>ZDAlignment</h3>

<ul>
<a name="zdgeomalignment"></a>
<li><font color="#4b3d8b"><b>ZDGeomAlignment</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDGeomAlignment
{
        UInt16 id
        double deltaX
        double deltaY
        double deltaZ
        double rotX
        double rotY
        double rotZ
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <U>Translation (x,y,z) and 3 rotation angles for 3 ZD objects:</U><br>
  <blockquote>
    BulkAlignment <br>
    PlacedEndplateWest <br>
    PlacedEndplateEast <br>
  </blockquote>

  <p>Detailed description is available in <a href=
"http://www.lns.cornell.edu/restricted/CLEO/CLEO3/soft/LibraryDocs/AZDGeomConst">
ZD3 Geometry: CLEO III constants</A><br>

  How to create data: Tracking will create these data. <br>
  ZDAlignedConstants are used by ZDGeom. The script includes:
  <blockquote><tt>
   source_format sel ZDGeomAlignmentFileSourceFormat<br>
   file in $env(C3_LIB)/data/zd.zdgeomalignment <br>
  </tt></blockquote></p>
</li>

</ul>


<a name="offline"></a>
<h3>ZDOffline</h3>

<ul>

<a name="zdadcpedestal"></a>
<li><font color="#4b3d8b"><b>ZDadcpedestal</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDadcpedestal
{ 
   UInt32 CellID
   float  pedestal
   float  pedestal_RMS
} 
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Charge pedestals and widths as measured in a ZD BigCal. One for each
wire; units are in TDC counts. The "charge pedestal" is the digitized
response of the charge circuit when there is no input signal.</p>
</li>

<a name="zdadcsaturation"></a>
<li><font color="#4b3d8b"><b>ZDadcsaturation</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDadcsaturation
{ 
   UInt32 CellID
   float  saturation
   float  saturation_RMS
} 
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Charge signal in TDC counts when the charge circuit is saturated. One
for each wire. Measured in a ZD Big Cal by injecting a huge amount of
charge and recording the charge circuit's response. This is the largest
possible charge signal that can be recorded, and is used to distinguish
time hits from charge hits. So-called "seed thresholds" (see <a
href="#zdfbuschannel">ZDFBUSChannel</a>) are computed from these measured
values.</p>
</li>

<a name="zdadc2charge"></a>
<li><font color="#4b3d8b"><b>ZDadc2charge</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDadc2charge
{
   UInt32 CellID
   float  offset
   float  slope
   float  quadratic
   float  cubic
   float  pedestal_noise
   float  slope_error
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Converts raw ADC measurement to uncorrected charge deposited in cell.<br>
  There is a 3rd order polynomial for each cell/wire along with errors on
the first two terms that may be useful for Monte Carlo someday.<br>
  Used in CDOffCal/DriftFunction:adc2charge.</p>
</li>

<a name="zdtdc2time"></a>
<li><font color="#4b3d8b"><b>ZDtdc2time</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDtcd2time
{
   UInt32 CellID 
   float  offset 
   float  slope 
   float  quadratic 
   float  cubic 
   float  pedestal_noise 
   float  slope_error 
   float  saturation
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Converts raw TDC to time for each hit (t-zero's, flight-time,
propagation and pulse height dependent time-slewing must still be
subtracted). Used in <tt>CDOffCal/DriftFunction::tdc2time</tt>.</p>
</li>

<a name="zdt0global"></a>
<li><font color="#4b3d8b"><b>ZDt0global</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDt0global
{
   UInt32 index
   float  tzero
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <i>Please fill in!</i></p>
</li>

<a name="zdt0crate"></a>
<li><font color="#4b3d8b"><b>ZDt0crate</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDt0crate
{
   UInt32 crate
   float  tzero
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  The t-zeros are split into 3 components which must be summed for each
wire/cell.</p>
</li>

<a name="zdt0card"></a>
<li><font color="#4b3d8b"><b>ZDt0card</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDt0card
{
   UInt32 indexNumber
   UInt32 card
   UInt32 crate
   float  tzero
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  See <a href="#zdt0crate">ZDt0crate</a>.</p>
</li>

<a name="zdt0channel"></a>
<li><font color="#4b3d8b"><b>ZDt0channel</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDt0channel
{
   UInt32 indexNumber
   UInt32 channel
   UInt32 card
   UInt32 crate
   float  tzero
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  See <a href="#zdt0crate">ZDt0crate</a>. These will be used in
<tt>CDOffCal/DriftFunction/tdc2time</tt>.</p>
</li>

<a name="zdt0channelv2"></a>
<li><font color="#4b3d8b"><b>ZDt0channelv2</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDt0channelv2
{
   UInt32 indexNumber
   UInt32 cellID
   UInt32 hvcard
   UInt32 card
   UInt32 crate
   float  t0CommonMode
   float  t0Channel
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <i>Please fill in!</i></p>
</li>

<a name="zdt0hvcard"></a>
<li><font color="#4b3d8b"><b>ZDt0hvcard</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDt0hvcard
{ 
   UInt32 indexNumber
   UInt32 hvcard
   UInt32 card
   UInt32 crate 
   float  tzero
} 
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <i>Please fill in!</i></p>
</li>

<a name="zddaqcellidmap"></a>
<li><font color="#4b3d8b"><b>ZDDaqCellIDMap</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDDaqCellIDMap
{
   UInt16 DaqId
   UInt16 CellId
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  This indexes the &quot;software&quot; cell ID to the hardware cell ID
in order to correct for miscablings.</p>
</li>

<a name="zddriftdata"></a>
<li><font color="#4b3d8b"><b>ZDDriftData</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDDriftData
{
   UInt32 Identifier
   float  Time
   float  Dist
   float  Indx
}
</</td></tr></table>

  <p><b>Explanation</b>:<br>
  This contains the drift function for the entire ZD. The Identifier is
not used. The &quot;Indx&quot; contains packed information as to which
drift function (layer) and which type of drift function (left+right
average, left, right, Z bin etc.) the particular (time,distance) point
belongs to. See the constructor of <tt>CDOffCal/DriftFunction.cc</tt> for more
information.</p>
</li>

<a name="zddriftdatav2"></a>
<li><font color="#4b3d8b"><b>ZDDriftDatav2</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDDriftDatav2
{
   UInt32 Identifier
   float  Time
   float  Dist
   UInt32 Indx
}
</</td></tr></table>

  <p><b>Explanation</b>:<br>
  <i>Please fill in!</i></p>
</li>

<a name="zdgarfield_distancecorrection"></a>
<li><font color="#4b3d8b"><b>ZDGarfield_DistanceCorrection</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDGarfield_DistanceCorrection
{
   UInt32 entry 
   float  drifttime
   float  z_position
   float  entrance_angle
   float  driftdistance_correction
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
 These contain corrections to drift-distance due to the field cage
geometry and magnetic field described as a function of time, entrance
angle and z-position.</p>
</li>

<a name="zdgarfield_timecorrection"></a>
<li><font color="#4b3d8b"><b>ZDGarfield_TimeCorrection</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDGarfield_TimeCorrection
{
   UInt32 entry
   float  driftdistance
   float  z_position
   float  entrance_angle
   float  drifttime_correction
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  These contain corrections to drift-distance due to the field cage
geometry and magnetic field described as a function of the drift-distance
one would expect for a zero-degree track, entrance angle, and
z-position.</p>
</li>

<a name="zdweightlayer"></a>
<li><font color="#4b3d8b"><b>ZDWeightLayer</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDWeightLayer
{
   UInt32 layer
   float  fittingweight
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  This was temporarily used in the CLEO-c testing code to provide fittingweights,
  in an analogous way to
  <a href="bdlTypesDR.html#drweightlayer">DRWeightLayer</a>.  See
  <a href="#zdweight2layerdriftentang">ZDWeight2LayerDriftEntAng</a>,
  <a href="#zdweight2layertheta">ZDWeight2LayerTheta</a> and
  <a href="#zdweight2layerphi">ZDWeight2LayerPhi</a>.
  </p>
</li>

<a name="zdweightdrift"></a>
<li><font color="#4b3d8b"><b>ZDWeightDrift</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDWeightDrift
{
   UInt32 indexNumber
   UInt32 layer
   UInt32 bin
   float  fittingweight
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  This was temporarily used in the CLEO-c testing code to provide fittingweights,
  in an analogous way to
  <a href="bdlTypesDR.html#drweightdrift">DRWeightDrift</a>.  See
  <a href="#zdweight2layerdriftentang">ZDWeight2LayerDriftEntAng</a>,
  <a href="#zdweight2layertheta">ZDWeight2LayerTheta</a> and
  <a href="#zdweight2layerphi">ZDWeight2LayerPhi</a>.
  </p>
</li>

<a name="zdweighttheta"></a>
<li><font color="#4b3d8b"><b>ZDWeightTheta</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDWeightTheta
{
   UInt32 indexNumber
   UInt32 layer
   UInt32 bin
   float  fittingweight
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  This was temporarily used in the CLEO-c testing code to provide fittingweights,
  in an analogous way to
  <a href="bdlTypesDR.html#drweighttheta">DRWeightTheta</a>.  See
  <a href="#zdweight2layerdriftentang">ZDWeight2LayerDriftEntAng</a>,
  <a href="#zdweight2layertheta">ZDWeight2LayerTheta</a> and
  <a href="#zdweight2layerphi">ZDWeight2LayerPhi</a>.
  </p>
</li>

<a name="zdweightphi"></a>
<li><font color="#4b3d8b"><b>ZDWeightPhi</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDWeightPhi
{
   UInt32 indexNumber
   UInt32 layer
   UInt32 bin
   float  fittingweight
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  This was temporarily used in the CLEO-c testing code to provide fittingweights,
  in an analogous way to
  <a href="bdlTypesDR.html#drweightphi">DRWeightPhi</a>.  See
  <a href="#zdweight2layerdriftentang">ZDWeight2LayerDriftEntAng</a>,
  <a href="#zdweight2layertheta">ZDWeight2LayerTheta</a> and
  <a href="#zdweight2layerphi">ZDWeight2LayerPhi</a>.
  </p>
</li>

<a name="zdweight2layerdriftentang"></a>
<li><font color="#4b3d8b"><b>ZDWeight2LayerDriftEntAng</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>Type: Constants
Name: ZDWeight2LayerDriftEntAng
{
   UInt32 layer
   UInt32 driftbin
   UInt32 entangbin
   float resolution
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  This is the main constants type for assigning hit resolutions for
  CLEO-c onward.  These hit resolutions are assigned as a function of
  three variables: ZD layer number, unsigned drift distance
  (normalized to the cell size at zero entrance angle), and the sine
  of the entrance angle.  Since the last two parameters are
  continuous, the hit resolution is determined via a 2-D linear
  interpolation, where the bin values themselves are given at the
  <i>centers</i> of the bins.  Outside of the defined range,
  resolutions are given as an extrapolation (so be sure the last two
  drift bins have non-negative slope!).</p>

  <p>Validity ranges of drift and entang, as well as numbers of bin
  divisions, are set using a &quot;fake layer zero&quot;, like
  this:</p>
<center><table><tr><td><pre>
layer    driftBin  EntAngBin  Resolution
  0       1          0           <font color="#006600">0.0 (min absDrift value)</font>
  0      <font color="#006600">15 (max)</font>    0           <font color="#006600">1.5 (max absDrift value)</font>
  0       0          1          <font color="#006600">-1.0 (min sinalpha value)</font>
  0       0         <font color="#006600">20 (max)</font>     <font color="#006600">1.0 (max sinalpha value)</font>
</pre></td></tr></table></center>

  <p>&quot;resolution&quot; is a multiplicative factor on 123 microns:
  a track fit chi<sup>2</sup> is defined like this:</p>
  <center>
  Fit chi<sup>2</sup> = Sum (residual_i)<sup>2</sup> / (&quot;resolution&quot;_i * 123 microns)<sup>2</sup>
  </center>

  <p>Note that <a href="#zdweight2layertheta">ZDWeight2LayerTheta</a>
  and <a href="#zdweight2layerphi">ZDWeight2LayerPhi</a> can also
  affect hit resolution.
  </p>
</li>

<a name="zdweight2layertheta"></a>
<li><font color="#4b3d8b"><b>ZDWeight2LayerTheta</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>Type: Constants
Name: ZDWeight2LayerTheta
{
   UInt32 layer
   UInt32 thetabin
   float resolution
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Since the resolution of a hit also depends on dip angle, this
  constants type provides a multiplicative correction.  Bins of
  <i>cos</i>(theta) are interpolated/extrapolated in the same way as
  <a href="#zdweight2layerdriftentang">ZDWeight2LayerDriftEntAng</a>.
  By convention, these corrections should always be normalized such
  that cos(theta) == 0 has a &quot;resolution&quot; value of 1.0.
  This way, the layer-by-layer dependence is characterized only by
  <a href="#zdweight2layerdriftentang">ZDWeight2LayerDriftEntAng</a>.</p>

  <p>Validity range and number of bins in cos(theta) are set using a
  &quot;fake layer zero&quot;, like this:</p>
<center><table><tr><td><pre>
layer    thetaBin  Resolution
  0       1          <font color="#006600">-1.0 (min cosTheta value)</font>
  0      <font color="#006600">20 (max)</font>     <font color="#006600">1.0 (max cosTheta value)</font>
</pre></td></tr></table></center>

  <p>This correction doesn't need to be set by hand (from data).  If
  ZDWeight2LayerTheta contains only
<center><table><tr><td><pre>
layer    thetaBin  Resolution
  0       0           0.0
</pre></td></tr></table></center>
  then a &quot;standard&quot; correction of (1 -
  cos(theta)<sup>2</sup>)<sup>-1/4</sup> will be applied.  This is
  proportional to the square root of the track length through a drift
  cell.</p>
</li>

<a name="zdweight2layerphi"></a>
<li><font color="#4b3d8b"><b>ZDWeight2LayerPhi</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>Type: Constants
Name: ZDWeight2LayerPhi
{
   UInt32 layer
   UInt32 phibin
   float resolution
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  The only justification for this constant is that it provides for
  future flexibility in assigning hit resolutions.  Bins of phi are
  interpolated cyclically, and the resolution correction (usually 1.0,
  I hope) is multiplied to that given by
  <a href="#zdweight2layerdriftentang">ZDWeight2LayerDriftEntAng</a>
  and <a href="#zdweight2layertheta">ZDWeight2LayerTheta</a>.

  <p>The number of bins is set using a &quot;fake layer zero&quot;,
  like this:</p>
<center><table><tr><td><pre>
layer    phiBin    Resolution
  0      <font color="#006600">20 (max)</font>      0.0
</pre></td></tr></table></center>

  <p>This correction doesn't need to be set by hand (from data).  If
  ZDWeight2LayerPhi contains only
<center><table><tr><td><pre>
layer    thetaBin  Resolution
  0       0           0.0
</pre></td></tr></table></center>
  then no correction will be applied (which is what you probably want
  to do!).</p>
</li>

<a name="zdwirequality"></a>
<li><font color="#4b3d8b"><b>ZDWireQuality</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDWireQuality
{
   UInt32 CellID
   UInt32 Quality
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  These are bitmapped codes meant as a more flexible &quot;bad wire
list&quot; (definitions undecided as yet but this will be a good place to
put it), a nonzero value of Quality means that the hit should probably
not be used.</p>
</li>

</ul>


<a name="online"></a>
<h3>ZDOnline</h3>

<ul>

<a name="zdfbus1877s"></a>
<li><font color="#4b3d8b"><b>ZDFBUS1887S</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDFBUS1877S
{
   UInt16  CSR0
   UInt32  CSR1
   UInt16  CSR18
   UInt16  BroadcastClass
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  The contents of the control and status registers (CSRs) of the LeCroy
Fastbus 1877S TDCs in the ZD Fastbus crates. These settings configure the
boards for normal operation, controlling things like sparsification,
number of hits stored per event, start/stop mode, and so on.<br>
  All boards within a single broadcast class can be written to in a
single operation. All ZD boards are members of the same broadcast
class. In those crates with MU baords as well, the MU boards are members
of a different broadcast class.</p>
</li>

<a name="zdfbuschannel"></a>
<li><font color="#4b3d8b"><b>ZDFBUSChannel</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDFBUSChannel
{
   UInt16  ChannelAddress  
   UInt16  DaqId
   UInt16  Crate           SelectBy
   UInt16  SparsThreshold
   UInt16  SeedThreshold
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  The information used by Fritz and the CPU in a ZD Fastbus crate to
process each raw TDC hit before putting it in the event stream. The
channel address is a bit-packed code that contains the Fastbus crate,
slot, and channel. Thus this word and the DaqId determine one part of the
ZD electronics map, from Fastbus channel to DaqId. (See <a
href="#zdelecmap">ZDElecMap</a> for more.) This map is used to label each
raw hit with a unique address describing from where it came. (For
handling miscablings, see <a href="#zddaqcellidmap">ZDDaqCellIDMap</a>.)
The sparsification threshold is used in the TDC board itself to discard
charge hits below a given threshold, typically just above pedestal (see
<a href="#zdadcpedestal">ZDadcpedestal</a>). The seed threshold is used
by Fritz to flag those hits that are above a particular level. In the ZD,
hits above the seed threshold are guaranteed to be time hits, since the
threshold is set at the maximum possible charge value (see <a
href="#adcsaturation">ZDadcsaturation</a>).<br>
  See the ConstantsMapping code for the details of the bit-packing.</p>
</li>

<a name="zdfbussequencerlist"></a>
<li><font color="#4b3d8b"><b>ZDFBUSSequencerList</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDFBUSSequencerList
{
   UInt32  Offset
   UInt32  Command
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Allows great flexibility in programming the details of the readout
sequence used to pull data from the Fastbus TDCs across the backplane
into Fritz. A list of special instructions (basically Fastbus backplane
cycles) can be stored here. In typical operation, these constants just
hold a single instruction indicating a standard readout sequence is to be
used.</p>
</li>

<a name="zdtqtcrate"></a>
<li><font color="#4b3d8b"><b>ZDTQTCrate</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDTQTCrate
{
   UInt16  Crate           SelectBy
   UInt16  CalDAC
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Constants used by ZDSbus. The height of the calibration pulse sent to
the ZD preamps during a ZD BigCal is controlled here&mdash;one setting
per TQT crate. The value is used to set an 8-bit DAC.</p>
</li>

<a name="zdtqtboard"></a>
<li><font color="#4b3d8b"><b>ZDTQTBoard</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDTQTBoard
{
   UInt16  BoardAddress
   UInt16  Crate           SelectBy
   UInt8   CalEnable
   UInt8   CalDriverEnable
   UInt16  Preamp0Voltage
   UInt16  Preamp1Voltage
   UInt16  Preamp2Voltage
   UInt16  Preamp3Voltage
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Constants used by ZDSbus to configure a TQT board for data-taking or a
BigCal. The BoardAddress is a bit-packed word combining the TQT crate and
slot number. The other quantities are as follows:
  <table>
  <tr><td>CalEnable</td>
      <td>Determine what combination of the four preamps attached to a
board are to be pulsed in a
calibration cycle</td></tr>
  <tr><td>CalDriverEnable</td>
      <td>A single bit that enables the circuit that produces the
calibration pulse that is sent to the preamps during calibration pulsing
(a BigCal)</td></tr>
  <tr><td>PreampNVoltage</td>
      <td>An 8-bit setting controlling the power supplied to each of the
four preamps attached to a single TQT board</td></tr>
  </table></p>
</li>

<a name="zdtqtchannel"></a>
<li><font color="#4b3d8b"><b>ZDTQTChannel</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDTQTChannel
{
   UInt16  ChannelAddress
   UInt16  Crate              SelectBy
   UInt16  TimeThreshold
   UInt16  TriggerThreshold
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Constants used by ZDSbus to configure each TQT channel. The
ChannelAddress is a bit-packed word that combines the TQT crate, slot,
and channel into a single word. The thresholds are 8-bit values that
control the discriminator threshold on the timing circuits for a
channel. Though there is no connection from the ZD to the trigger, the
trigger discriminator settings are kept in the constants here for
parallelism with the DR since the TQT electronics are (essentially)
identical.</p>
</li>

<a name="zdtstrigboard"></a>
<li><font color="#4b3d8b"><b>ZDTSTrigBoard</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDTSTrigBoard
{
   UInt16   index
   String   Component    SelectBy
   String   BoardName
   UInt16   L1width
   UInt16   L1delay
   boolean  L1enable
   UInt16   CALwidth
   UInt16   CALdelay
   boolean  CALenable
   boolean  InternalTrigEnable
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Constants used by the ZD Timing System to set up its Trig board. The
InternalTrigEnable bit controls whether a special stand-alone mode is
used, where software commands can be used to trigger the system. In
normal operation (data-taking or BigCal), the trigger system provides the
triggers, "internal triggering" is disabled, and none of these settings
are used. For more information, see the <a
href="/~tom/doc/TimingSystem.pdf">Timing System documentation</a>.</p>
</li>

<a name="zdtsgateboard"></a>
<li><font color="#4b3d8b"><b>ZDTSGateBoard</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDTSGateBoard
{
   UInt16   index
   String   Component    SelectBy
   String   BoardName
   UInt16   FBUSCrate
   UInt16   G1width
   UInt16   G1delay
   UInt16   G2width
   UInt16   G2delay
   UInt16   G3width
   UInt16   G3delay
   UInt16   G1enable
   UInt16   G2enable
   UInt16   G3enable
   UInt16   CALenable
   UInt16   InvertMask
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Constants used by the ZD Timing System that determine the width and
delay of various gating signals sent to the Fastbus and TQT crates to
coordinate digitization of drift chamber data. For more information, see
the <a href="/~tom/doc/TimingSystem.pdf">Timing System
documentation</a>. Note that the widths and delays are the raw values as
stored in the registers, which happen to determine not the width and
delay of each gate, but (0x3FF - width or delay) of each gate. Sorry,
that's the way it is. So widths will become <i>smaller</i> linearly as
the width register value is <i>increased</i>, etc.<br>
  The FBUSCrate field is not used.<br>
  The InvertMask (a 6-bit register) allows one to determine the polarity
of the signals sent out by the timing system. (Positive or negative
logic, basically.)<br>
  The various Enables (each a 6-bit register) determine which of the four
possible signals (G1-3, CAL) are output on each of the 6 connectors on a
given Gate board.</p>
</li>

</ul>


<a name="miscellaneous"></a>
<h3>ZDMiscellaneous</h3>

<ul>

<a name="zdelecmap"></a>
<li><font color="#4b3d8b"><b>ZDElecMap</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDElecMap
{
   UInt16   DaqId
   UInt16   TQTChannelAddress
   UInt16   PreAmpChannelAddress
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  Contains the rest of the information required to build a complete
electronics map for the drift chamber. <a
href="#zdfbuschannel">ZDFBUSChannel</a> above contains the DaqId to
Fastbus mapping, and this contains the mapping to TQT channel and preamp
channel. Each of the "address" words above is again a bit-packed word
combining crate, slot, and channel (TQT) or layer, sector,
channel-in-sector (preamp) information into a single 16-bit word.<br>
  See the ConstantsMapping code for the details of the bit-packing.</p>
</li>

<a name="zdtqttofbus"></a>
<li><font color="#4b3d8b"><b>ZDTQTtoFBUS</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDTQTtoFBUS
{
   UInt16  TQTChannelAddress
   UInt16  FBUSChannelAddress
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  An alternative description of the same electronics map stored in <a
href="#zdelecmap">ZDElecMap</a>, but here the mapping is directly from
Fastbus channel to TQT channel, without an intervening DaqId lookup. Also
see <a href="#zdpreamptotqt">ZDPreAmpToTQT</a> below for the second part
of the map formulated in this fashion.<br>
  See the ConstantsMapping code for the details of the bit-packing.</p>
</li>

<a name="zdpreamptotqt"></a>
<li><font color="#4b3d8b"><b>ZDPreAmpToTQT</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDPreAmpToTQT
{
   UInt16  PreAmpChannelAddress
   UInt16  TQTChannelAddress
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  The second part of the alternative description of the drift chamber
electronics map.(For this first part, see <a
href="#zdtqttofbus">ZDTQTtoFBUS</a> above.) Here the mapping is from
preamp channel to TQT channel, again with bit-packed words.<br>
  See the ConstantsMapping code for the details of the bit-packing.</p>
</li>

<a name="zddeadwires"></a>
<li><font color="#4b3d8b"><b>ZDDeadWires</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDDeadWires
{
   UInt16   Index
   UInt16   CellID
   UInt16   Layer
   UInt32   Code
   float    Efficiency
   float    Noise
   UInt32   Notes
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <i>Please fill in!</i></p>
</li>

<a name="zdvarious"></a>
<li><font color="#4b3d8b"><b>ZDvarious</b></font><br> 

  <table bgcolor="#dcdcdc" border="0" cellpadding="3"><tr><td>
<pre>
Type: Constants
Name: ZDvarious
{ 
   UInt32 Identifier
   int    integer1 
   int    integer2
   float  float1
   float  float2 
}
</pre></td></tr></table>

  <p><b>Explanation</b>:<br>
  <i>Please fill in!</i></p>
</li>

</ul>


<a name="montecarlo"></a>
<h3>ZDMonteCarlo</h3>

<ul>

<li><font color="#4b3d8b"><b>ZDMCLyreff</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCWireff</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCPhlayr</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCCathname</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCPhwire</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCCoseff</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCResolutions</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCEff</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCSmear</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCHitJump</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCSpefud</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCIons</b></font></li>
<li><font color="#4b3d8b"><b>ZDMCTmlayr</b></font></li>

</ul>



<hr>

<p><a href="mailto:hubert@lns.cornell.edu">Hubert Schwarthoff</a></p>
</body>
</html>
