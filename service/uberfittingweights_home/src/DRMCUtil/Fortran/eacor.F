C 
C  $Id: eacor.F,v 1.2 2003/08/20 15:07:19 dubrovin Exp $
C 
C  $Log: eacor.F,v $
C  Revision 1.2  2003/08/20 15:07:19  dubrovin
C  Add standard output message and standard cvs stuff
C
***================================================
***  Histogram-like correction/distortion in CLEOG
***  for residuals vs d.c.a and entrance angle. 
***================================================

      real function eacor(ea,dca)

C   Include files :
C   ---------------------
C   Cleo3 Message Reporter
#include "ToolBox/report.inc"


c   Local pre-defined variables:
C   ---------------------------
C   chmess - Text of current message
      character*132 chmess

      character*(*) chrcss, chrcsr, chrcst, chrcsd, chrcsa
      parameter(chrcss='$RCSfile: eacor.F,v $')
      parameter(chrcsr='$Revision: 1.2 $')
      parameter(chrcst='$State: Exp $')
      parameter(chrcsd='$Date: 2003/08/20 15:07:19 $')
      parameter(chrcsa='$Author: dubrovin $')
 
      character*(*) crname
      parameter(    crname = 'eacor' )
C   ---------------------------

      real ea,dca
      real eas

      integer Nea, Ndca
      parameter (Nea=37)
      parameter (Ndca=41)
      integer iea, idca

      real Uea(Nea)
      real Udca(Ndca)
      real  EAmin,  EAmax,  EABinSiz 
      real DCAmin, DCAmax, DCABinSiz
      real EAminB, DCAminB

      real CorC(Nea,Ndca)

      real Cor1D01(Nea)
      real Cor1D02(Nea)
      real Cor1D03(Nea)
      real Cor1D04(Nea)
      real Cor1D05(Nea)
      real Cor1D06(Nea)
      real Cor1D07(Nea)
      real Cor1D08(Nea)
      real Cor1D09(Nea)
      real Cor1D10(Nea)
      real Cor1D11(Nea)
      real Cor1D12(Nea)
      real Cor1D13(Nea)
      real Cor1D14(Nea)
      real Cor1D15(Nea)
      real Cor1D16(Nea)
      real Cor1D17(Nea)
      real Cor1D18(Nea)
      real Cor1D19(Nea)
      real Cor1D20(Nea)
      real Cor1D21(Nea)
      real Cor1D22(Nea)
      real Cor1D23(Nea)
      real Cor1D24(Nea)
      real Cor1D25(Nea)
      real Cor1D26(Nea)
      real Cor1D27(Nea)
      real Cor1D28(Nea)
      real Cor1D29(Nea)
      real Cor1D30(Nea)
      real Cor1D31(Nea)
      real Cor1D32(Nea)
      real Cor1D33(Nea)
      real Cor1D34(Nea)
      real Cor1D35(Nea)
      real Cor1D36(Nea)
      real Cor1D37(Nea)
      real Cor1D38(Nea)
      real Cor1D39(Nea)
      real Cor1D40(Nea)
      real Cor1D41(Nea)

      equivalence (Cor1D01,CorC(1,01))
      equivalence (Cor1D02,CorC(1,02))
      equivalence (Cor1D03,CorC(1,03))
      equivalence (Cor1D04,CorC(1,04))
      equivalence (Cor1D05,CorC(1,05))
      equivalence (Cor1D06,CorC(1,06))
      equivalence (Cor1D07,CorC(1,07))
      equivalence (Cor1D08,CorC(1,08))
      equivalence (Cor1D09,CorC(1,09))
      equivalence (Cor1D10,CorC(1,10))
      equivalence (Cor1D11,CorC(1,11))
      equivalence (Cor1D12,CorC(1,12))
      equivalence (Cor1D13,CorC(1,13))
      equivalence (Cor1D14,CorC(1,14))
      equivalence (Cor1D15,CorC(1,15))
      equivalence (Cor1D16,CorC(1,16))
      equivalence (Cor1D17,CorC(1,17))
      equivalence (Cor1D18,CorC(1,18))
      equivalence (Cor1D19,CorC(1,19))
      equivalence (Cor1D20,CorC(1,20))
      equivalence (Cor1D21,CorC(1,21))
      equivalence (Cor1D22,CorC(1,22))
      equivalence (Cor1D23,CorC(1,23))
      equivalence (Cor1D24,CorC(1,24))
      equivalence (Cor1D25,CorC(1,25))
      equivalence (Cor1D26,CorC(1,26))
      equivalence (Cor1D27,CorC(1,27))
      equivalence (Cor1D28,CorC(1,28))
      equivalence (Cor1D29,CorC(1,29))
      equivalence (Cor1D30,CorC(1,30))
      equivalence (Cor1D31,CorC(1,31))
      equivalence (Cor1D32,CorC(1,32))
      equivalence (Cor1D33,CorC(1,33))
      equivalence (Cor1D34,CorC(1,34))
      equivalence (Cor1D35,CorC(1,35))
      equivalence (Cor1D36,CorC(1,36))
      equivalence (Cor1D37,CorC(1,37))
      equivalence (Cor1D38,CorC(1,38))
      equivalence (Cor1D39,CorC(1,39))
      equivalence (Cor1D40,CorC(1,40))
      equivalence (Cor1D41,CorC(1,41))

* Residuals arrays for insertation in data statement:

      data Cor1D01/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D02/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D03/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D04/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.438, 0.050,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D05/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000,-0.631,-0.288, 0.070,
     > 0.367, 0.560, 0.491, 0.423, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D06/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.341, 0.330, 0.209, 0.057,-0.101,-0.201,-0.104,-0.054,
     >-0.007,-0.020, 0.000,-0.399,-0.475,-0.736,-0.130, 0.172,
     > 0.379, 0.479, 0.491, 0.433, 0.439, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D07/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.241,
     > 0.207, 0.204, 0.151, 0.070, 0.004,-0.053,-0.036, 0.009,
     > 0.030, 0.006, 0.000,-0.138,-0.662,-0.247,-0.056, 0.082,
     > 0.211, 0.189, 0.179, 0.118, 0.074, 0.331, 0.575, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D08/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000,-0.044,-0.033,-0.057,-0.100,-0.105,-0.043,-0.002,
     >-0.041,-0.061, 0.000,-0.207,-0.221,-0.268,-0.298,-0.271,
     >-0.249,-0.070,-0.048,-0.090,-0.103, 0.031, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D09/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000,-0.046,-0.022,-0.022, 0.036, 0.007,
     >-0.038,-0.058,-0.201,-0.165,-0.225,-0.303,-0.411,-0.394,
     >-0.433,-0.406, 0.000,-0.169,-0.086, 0.148, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D10/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000,-0.104,-0.043, 0.003,-0.001, 0.036, 0.011,-0.010,
     >-0.022,-0.042,-0.064,-0.112,-0.136,-0.208,-0.226,-0.192,
     >-0.214,-0.199,-0.090,-0.092,-0.016, 0.029, 0.221, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D11/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.115,
     >-0.140,-0.045,-0.020,-0.004, 0.049, 0.030, 0.001,-0.001,
     >-0.006,-0.015,-0.045,-0.079,-0.094,-0.116,-0.112,-0.098,
     >-0.054,-0.124,-0.071,-0.049,-0.002, 0.109, 0.149, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D12/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.089,-0.101,
     >-0.065, 0.018,-0.026, 0.002, 0.019, 0.008,-0.012,-0.009,
     >-0.017,-0.028,-0.023,-0.047,-0.049,-0.064,-0.064,-0.037,
     >-0.003,-0.068,-0.050,-0.012, 0.004, 0.089, 0.132, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D13/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.061,-0.047,
     >-0.014,-0.001,-0.027, 0.009, 0.003, 0.003,-0.003,-0.006,
     >-0.011,-0.018,-0.038,-0.034,-0.042,-0.050,-0.058,-0.019,
     > 0.010,-0.024,-0.049, 0.023, 0.031, 0.068, 0.023, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D14/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.020, 0.016,
     > 0.005,-0.016, 0.006,-0.007,-0.008, 0.001,-0.010,-0.008,
     >-0.011,-0.017,-0.036,-0.021,-0.036,-0.039,-0.041,-0.012,
     > 0.013,-0.012, 0.007,-0.014, 0.010, 0.078, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D15/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.015,-0.008,
     > 0.003,-0.016, 0.023,-0.025,-0.009, 0.000,-0.013,-0.015,
     >-0.019,-0.017,-0.048,-0.030,-0.032,-0.037,-0.045,-0.016,
     > 0.024,-0.013,-0.003, 0.004,-0.032, 0.079, 0.004, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D16/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.009,-0.005,
     >-0.037,-0.003,-0.009,-0.022,-0.022,-0.008,-0.014,-0.014,
     >-0.016,-0.020,-0.050,-0.038,-0.024,-0.031,-0.047,-0.027,
     > 0.002,-0.013,-0.001,-0.007, 0.013,-0.027, 0.001, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D17/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.039,-0.029,
     > 0.006,-0.016,-0.019,-0.010,-0.009,-0.013,-0.016,-0.022,
     >-0.017,-0.026,-0.067,-0.044,-0.013,-0.040,-0.034,-0.028,
     >-0.003,-0.016, 0.007,-0.012,-0.011, 0.002, 0.001, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D18/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.037,-0.026,
     >-0.005,-0.004,-0.017,-0.044,-0.026,-0.019,-0.025,-0.030,
     >-0.010,-0.029,-0.076,-0.046,-0.037,-0.033,-0.048,-0.027,
     >-0.036,-0.029,-0.040, 0.001, 0.011, 0.009, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D19/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.034, 0.002,
     > 0.013,-0.047,-0.027,-0.014,-0.040,-0.030,-0.043,-0.040,
     >-0.053,-0.037,-0.068,-0.045,-0.034,-0.044,-0.055,-0.037,
     >-0.057,-0.024,-0.039,-0.038,-0.056,-0.015, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D20/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.078, 0.018,
     >-0.013,-0.052,-0.013,-0.045,-0.050,-0.040,-0.035,-0.047,
     >-0.042,-0.045,-0.043,-0.029,-0.034,-0.034,-0.045,-0.052,
     >-0.047,-0.040,-0.044,-0.032,-0.068,-0.036, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D21/
     > 0.000, 0.000, 0.000, 0.000, 0.000,-0.013,-0.014, 0.017,
     >-0.031,-0.042, 0.037, 0.023, 0.005, 0.003,-0.003, 0.021,
     >-0.004, 0.004,-0.021, 0.008,-0.005,-0.033,-0.037,-0.041,
     >-0.023,-0.037,-0.002, 0.012, 0.015, 0.035, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D22/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.150, 0.108,
     > 0.099, 0.038, 0.066, 0.061, 0.060, 0.058, 0.069, 0.055,
     > 0.057, 0.053, 0.002, 0.019, 0.032, 0.034, 0.029, 0.035,
     > 0.048, 0.011, 0.035, 0.032, 0.074,-0.028, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D23/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.016, 0.035,
     > 0.043, 0.014, 0.065, 0.054, 0.076, 0.073, 0.065, 0.046,
     > 0.059, 0.045, 0.042, 0.026, 0.035, 0.034, 0.047, 0.016,
     > 0.020, 0.038, 0.040, 0.051, 0.014,-0.087, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D24/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.048, 0.018,
     > 0.013, 0.019, 0.036, 0.054, 0.053, 0.061, 0.065, 0.045,
     > 0.021, 0.033, 0.060, 0.023, 0.024, 0.030, 0.028, 0.009,
     > 0.019, 0.022, 0.017, 0.015, 0.021, 0.008,-0.067, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D25/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.007, 0.009,
     > 0.017, 0.030, 0.042, 0.048, 0.034, 0.038, 0.052, 0.036,
     > 0.022, 0.028, 0.011, 0.024, 0.029, 0.029, 0.039, 0.002,
     > 0.002, 0.021, 0.018, 0.037, 0.002, 0.030, 0.018, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D26/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.031,-0.034,
     > 0.038, 0.009, 0.043, 0.068, 0.044, 0.035, 0.033, 0.025,
     > 0.034, 0.025, 0.023, 0.020, 0.026, 0.015, 0.028, 0.009,
     > 0.001,-0.001,-0.025,-0.007, 0.035,-0.001, 0.031, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D27/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.015,-0.077,
     > 0.007, 0.018,-0.001, 0.045, 0.055, 0.023, 0.032, 0.021,
     > 0.023, 0.023, 0.014, 0.016, 0.031, 0.025, 0.026, 0.001,
     >-0.010,-0.007, 0.009, 0.031, 0.013, 0.005,-0.034, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D28/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.011,-0.004,
     >-0.026, 0.013,-0.003, 0.033, 0.036, 0.024, 0.029, 0.027,
     > 0.024, 0.011, 0.000, 0.018, 0.024, 0.026, 0.014,-0.002,
     > 0.010,-0.003,-0.044, 0.024,-0.003, 0.008, 0.001, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D29/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.041, 0.041,
     >-0.031,-0.018, 0.016, 0.016, 0.033, 0.019, 0.028, 0.018,
     > 0.020, 0.012, 0.002, 0.017, 0.033, 0.021, 0.033,-0.001,
     > 0.006,-0.012, 0.033, 0.018,-0.010,-0.006,-0.072, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D30/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.077,
     > 0.045,-0.009, 0.027, 0.028, 0.014, 0.017, 0.034, 0.022,
     > 0.010, 0.017,-0.018, 0.038, 0.045, 0.060, 0.063, 0.032,
     > 0.013, 0.031, 0.024,-0.015,-0.019,-0.014,-0.069, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D31/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.110,
     > 0.109, 0.002, 0.003, 0.016, 0.007,-0.006, 0.021, 0.007,
     > 0.022, 0.028, 0.021, 0.070, 0.086, 0.111, 0.098, 0.037,
     > 0.050, 0.067, 0.042, 0.012, 0.002,-0.098,-0.164, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D32/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.056, 0.053, 0.000, 0.016,-0.035,-0.010, 0.014,
     > 0.019, 0.039, 0.030, 0.100, 0.159, 0.233, 0.248, 0.135,
     > 0.147, 0.131, 0.042, 0.059, 0.017,-0.107,-0.202, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D33/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.064, 0.052, 0.000,-0.036,-0.003,
     > 0.031, 0.051, 0.103, 0.174, 0.230, 0.335, 0.439, 0.438,
     > 0.375, 0.251, 0.000, 0.157, 0.022,-0.095,-0.464, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D34/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.016, 0.061, 0.130, 0.071, 0.029,-0.011,
     > 0.027, 0.053, 0.000, 0.219, 0.242, 0.309, 0.311, 0.285,
     > 0.157, 0.022, 0.042,-0.003, 0.066, 0.015, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D35/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.252,
     >-0.236,-0.191,-0.163,-0.083, 0.015, 0.030, 0.006,-0.022,
     >-0.021,-0.006, 0.000, 0.163, 0.255, 0.169,-0.009,-0.144,
     >-0.208,-0.292,-0.252,-0.162,-0.150,-0.319, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D36/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,-0.507,
     >-0.436,-0.386,-0.235,-0.053, 0.119, 0.124, 0.106, 0.033,
     >-0.008, 0.016, 0.000, 0.594, 1.244, 0.287, 0.021,-0.196,
     >-0.440,-0.523,-0.422,-0.403,-0.339, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D37/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000,-0.378, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.467, 0.741, 0.005,-0.229,
     >-0.461,-0.574,-0.479, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D38/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.435, 0.190,-0.123,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D39/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.286, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D40/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /
      data Cor1D41/
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
     > 0.000, 0.000, 0.000, 0.000, 0.000
     >            /



* Nodes for D.C.A.:        41
      data Udca/
     >-10.00, -9.50, -9.00, -8.50, -8.00, -7.50, -7.00, -6.50,
     > -6.00, -5.50, -5.00, -4.50, -4.00, -3.50, -3.00, -2.50,
     > -2.00, -1.50, -1.00, -0.50,  0.00,  0.50,  1.00,  1.50,
     >  2.00,  2.50,  3.00,  3.50,  4.00,  4.50,  5.00,  5.50,
     >  6.00,  6.50,  7.00,  7.50,  8.00,  8.50,  9.00,  9.50,
     > 10.00/
* Nodes for E.A.  :        37
      data Uea/
     >-90.00,-85.00,-80.00,-75.00,-70.00,-65.00,-60.00,-55.00,
     >-50.00,-45.00,-40.00,-35.00,-30.00,-25.00,-20.00,-15.00,
     >-10.00, -5.00,  0.00,  5.00, 10.00, 15.00, 20.00, 25.00,
     > 30.00, 35.00, 40.00, 45.00, 50.00, 55.00, 60.00, 65.00,
     > 70.00, 75.00, 80.00, 85.00, 90.00/


***First entry stuff
        integer Nentry
        data    Nentry/0/

      if(Nentry.eq.0) then
         Nentry=1

*        chmess='E.A. distortion, '//chrcsd//', '//chrcsr
        chmess='E.A. distortion, 2003/08/20, V01'
        call report(MS_INFO, crname, chmess)

*       print *, ' eacor.f - E.A. correction, 2003/08/20, V01'
*          do iea=1,Nea
*                print 1002, (CorC(iea,idca),idca=1,Ndca)  
*          enddo
*1002   format(50(10(1x,f6.3)/))

       EAmin=Uea(1)
       EAmax=Uea(Nea)
       EABinSiz=(EAmax-EAmin) / (Nea-1)
       EAminB=EAmin-0.5*EABinSiz

       DCAmin=Udca(1)
       DCAmax=Udca(Ndca)
       DCABinSiz=(DCAmax-DCAmin) / (Ndca-1)
       DCAminB=DCAmin-0.5*DCABinSiz

*       print *, 'EA : min, max, binsiz', EAmin,  EAmax,  EABinSiz  
*       print *, 'DCA: min, max, binsiz', DCAmin, DCAmax, DCABinSiz

      endif

*** Serial entry: find eacor for the point (ea,dca)

      eacor=0.

      eas=ea      
***----------------------------
*** Apply 45o symmetry:
*      if(ea.lt.-45.) eas=ea+90.      
*      if(ea.gt. 45.) eas=ea-90.      
***----------------------------

      if(eas.gt.EAmax) goto 1111
      if(eas.lt.EAmin) goto 1111
      
      if(dca.gt.DCAmax) goto 1111
      if(dca.lt.DCAmin) goto 1111


      iea  = (eas- EAminB)/EABinSiz + 1
      idca = (dca-DCAminB)/DCABinSiz+ 1

      eacor=CorC(iea,idca) 

 1111 continue
      end
